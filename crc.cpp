uint32_t Formatter::_CalculateCrcEkms304(const Container::ByteSpan &span)
{
	static const uint32_t lookup[256] = {
		0x00000000, 0x00400007, 0x0080000E, 0x00C00009, 0x0100001C, 0x0140001B, 0x01800012, 0x01C00015,
		0x02000038, 0x0240003F, 0x02800036, 0x02C00031, 0x03000024, 0x03400023, 0x0380002A, 0x03C0002D,
		0x04000070, 0x04400077, 0x0480007E, 0x04C00079, 0x0500006C, 0x0540006B, 0x05800062, 0x05C00065,
		0x06000048, 0x0640004F, 0x06800046, 0x06C00041, 0x07000054, 0x07400053, 0x0780005A, 0x07C0005D,
		0x080000E0, 0x084000E7, 0x088000EE, 0x08C000E9, 0x090000FC, 0x094000FB, 0x098000F2, 0x09C000F5,
		0x0A0000D8, 0x0A4000DF, 0x0A8000D6, 0x0AC000D1, 0x0B0000C4, 0x0B4000C3, 0x0B8000CA, 0x0BC000CD,
		0x0C000090, 0x0C400097, 0x0C80009E, 0x0CC00099, 0x0D00008C, 0x0D40008B, 0x0D800082, 0x0DC00085,
		0x0E0000A8, 0x0E4000AF, 0x0E8000A6, 0x0EC000A1, 0x0F0000B4, 0x0F4000B3, 0x0F8000BA, 0x0FC000BD,
		0x100001C0, 0x104001C7, 0x108001CE, 0x10C001C9, 0x110001DC, 0x114001DB, 0x118001D2, 0x11C001D5,
		0x120001F8, 0x124001FF, 0x128001F6, 0x12C001F1, 0x130001E4, 0x134001E3, 0x138001EA, 0x13C001ED,
		0x140001B0, 0x144001B7, 0x148001BE, 0x14C001B9, 0x150001AC, 0x154001AB, 0x158001A2, 0x15C001A5,
		0x16000188, 0x1640018F, 0x16800186, 0x16C00181, 0x17000194, 0x17400193, 0x1780019A, 0x17C0019D,
		0x18000120, 0x18400127, 0x1880012E, 0x18C00129, 0x1900013C, 0x1940013B, 0x19800132, 0x19C00135,
		0x1A000118, 0x1A40011F, 0x1A800116, 0x1AC00111, 0x1B000104, 0x1B400103, 0x1B80010A, 0x1BC0010D,
		0x1C000150, 0x1C400157, 0x1C80015E, 0x1CC00159, 0x1D00014C, 0x1D40014B, 0x1D800142, 0x1DC00145,
		0x1E000168, 0x1E40016F, 0x1E800166, 0x1EC00161, 0x1F000174, 0x1F400173, 0x1F80017A, 0x1FC0017D,
		0x20000380, 0x20400387, 0x2080038E, 0x20C00389, 0x2100039C, 0x2140039B, 0x21800392, 0x21C00395,
		0x220003B8, 0x224003BF, 0x228003B6, 0x22C003B1, 0x230003A4, 0x234003A3, 0x238003AA, 0x23C003AD,
		0x240003F0, 0x244003F7, 0x248003FE, 0x24C003F9, 0x250003EC, 0x254003EB, 0x258003E2, 0x25C003E5,
		0x260003C8, 0x264003CF, 0x268003C6, 0x26C003C1, 0x270003D4, 0x274003D3, 0x278003DA, 0x27C003DD,
		0x28000360, 0x28400367, 0x2880036E, 0x28C00369, 0x2900037C, 0x2940037B, 0x29800372, 0x29C00375,
		0x2A000358, 0x2A40035F, 0x2A800356, 0x2AC00351, 0x2B000344, 0x2B400343, 0x2B80034A, 0x2BC0034D,
		0x2C000310, 0x2C400317, 0x2C80031E, 0x2CC00319, 0x2D00030C, 0x2D40030B, 0x2D800302, 0x2DC00305,
		0x2E000328, 0x2E40032F, 0x2E800326, 0x2EC00321, 0x2F000334, 0x2F400333, 0x2F80033A, 0x2FC0033D,
		0x30000240, 0x30400247, 0x3080024E, 0x30C00249, 0x3100025C, 0x3140025B, 0x31800252, 0x31C00255,
		0x32000278, 0x3240027F, 0x32800276, 0x32C00271, 0x33000264, 0x33400263, 0x3380026A, 0x33C0026D,
		0x34000230, 0x34400237, 0x3480023E, 0x34C00239, 0x3500022C, 0x3540022B, 0x35800222, 0x35C00225,
		0x36000208, 0x3640020F, 0x36800206, 0x36C00201, 0x37000214, 0x37400213, 0x3780021A, 0x37C0021D,
		0x380002A0, 0x384002A7, 0x388002AE, 0x38C002A9, 0x390002BC, 0x394002BB, 0x398002B2, 0x39C002B5,
		0x3A000298, 0x3A40029F, 0x3A800296, 0x3AC00291, 0x3B000284, 0x3B400283, 0x3B80028A, 0x3BC0028D,
		0x3C0002D0, 0x3C4002D7, 0x3C8002DE, 0x3CC002D9, 0x3D0002CC, 0x3D4002CB, 0x3D8002C2, 0x3DC002C5,
		0x3E0002E8, 0x3E4002EF, 0x3E8002E6, 0x3EC002E1, 0x3F0002F4, 0x3F4002F3, 0x3F8002FA, 0x3FC002FD
	};

	uint32_t crc = 0xF8DD4258;
	uint8_t pos = 0;

	for (uint32_t i = 0; i < span.size; i++)
	{
		pos = (crc ^ (span.data[i] << 24)) >> 24;
		crc = (crc << 8) ^ lookup[pos];
	}

	return crc;
}
